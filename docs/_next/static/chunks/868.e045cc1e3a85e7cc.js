(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[868],{6868:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>tl});var s=i(7876),a=i(4232),h=i(8362),l=i.n(h);let n=new h.Events.EventEmitter;var r=function(t){return t.START_GAME="START_GAME",t.END_GAME="END_GAME",t.EXIT_GAME="EXIT_GAME",t.CHANGE_BACKGROUND="CHANGE_BACKGROUND",t}({});function o(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function c(t,e){var i=o(t,e,"get");return i.get?i.get.call(t):i.value}function d(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function m(t,e,i){d(t,e),e.set(t,i)}function g(t,e,i){var s=o(t,e,"set");if(s.set)s.set.call(t,i);else{if(!s.writable)throw TypeError("attempted to set read only private field");s.value=i}return i}function u(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function b(t,e){d(t,e),e.add(t)}let y={scene:{boot:"boot",tutorial:"tutorial",game:"game",timerManager:"timerManager",exitManager:"exitManager",basketManager:"basketManager",outro:"outro"},audio:{music:"music",success:"success",error:"error",help:"help",bubblepop:"bubblepop",bubbleshoot:"bubbleshoot",endWin:"endWin",endFailed:"endFailed"},image:{iconSandClock:"iconSandClock",backgroundGame:"backgroundGame",backgroundLogo:"backgroundLogo",backgroundScore:"backgroundScore",logo:"logo",iconHelp:"iconHelp",iconScore:"iconScore",iconLive:"iconLive",logoPhaser:"logoPhaser",endWin:"endWin",endFailed:"endFailed",basket:"basket",bonus:"bonus",obj1:"obj1",shadowObj:"shadowObj",btnExitGame:"btnExitGame",btnConfirm:"btnConfirm",btnCancel:"btnCancel",popupExitGame:"popupExitGame",tutorialTastoAvanti:"tutorialTastoAvanti"},spritesheet:{tutorialPlayer01:{frameWidth:264,frameHeight:292,key:"tutorialPlayer01"},tutorialPlayer02:{frameWidth:264,frameHeight:292,key:"tutorialPlayer02"},tutorialPlayer03:{frameWidth:264,frameHeight:292,key:"tutorialPlayer03"},tutorialText01:{frameWidth:897,frameHeight:253,key:"tutorialText01"},tutorialText02:{frameWidth:897,frameHeight:253,key:"tutorialText02"},tutorialText03:{frameWidth:897,frameHeight:253,key:"tutorialText03"},confetti_left:{frameWidth:195,frameHeight:177.5,key:"confetti_left"},confetti_right:{frameWidth:195,frameHeight:177.5,key:"confetti_right"},starsEffect:{frameWidth:184,frameHeight:184,key:"starsEffect"}},keyAnim:{animStars:"animStars",animTutorialPlayer01:"animTutorialPlayer01",animTutorialPlayer02:"animTutorialPlayer02",animTutorialPlayer03:"animTutorialPlayer03",animStartTutorialText01:"animStartTutorialText01",animStartTutorialText02:"animStartTutorialText02",animStartTutorialText03:"animStartTutorialText03",animEndTutorialText01:"animEndTutorialText01",animEndTutorialText02:"animEndTutorialText02",animEndTutorialText03:"animEndTutorialText03"},font:{"PaytoneOne-Regular":"PaytoneOne-Regular"},registry:{score:"score",coins:"coins",timer:"timer"}},p=t=>{for(let e in y.audio)t.load.audio(e,"/games/basket/sounds/".concat(e,".mp3"))},S=t=>{for(let[e,i]of Object.entries(y.spritesheet))t.load.spritesheet(e,"/games/basket/images/".concat(e,".png"),{frameWidth:i.frameWidth,frameHeight:i.frameHeight})},k=t=>{for(let e in y.image)t.load.image(e,"/games/basket/images/".concat(e,".png"))},f=t=>{for(let e in y.font)t.load.font("Paytone One","/games/basket/fonts/".concat(e,".ttf"),"truetype")};var T=new WeakMap,O=new WeakMap,x=new WeakSet,w=new WeakSet;class A extends h.Scene{init(t){this.isInit||(this.logoPhaser=t.logoPhaser,this.isInit=!0)}preload(){console.log("Load boot.ts"),u(this,x,v).call(this),this.load.on("progress",t=>{c(this,O).clear(),c(this,O).fillStyle(0xbf5505,1),c(this,O).fillRoundedRect(this.cameras.main.width/4,this.cameras.main.height-96,this.cameras.main.width/2*t,16,8)},this),this.load.on("complete",()=>{this.startGame()}),u(this,w,E).call(this),this.registry.set(y.registry.score,0),this.registry.set(y.registry.coins,0),this.load.image("logoPhaser",this.logoPhaser),console.log("Load Images boot.ts")}create(){console.log("boot")}startGame(){console.log("Start Tutorial"),this.scene.start(y.scene.tutorial)}constructor(){super({key:y.scene.boot}),b(this,x),b(this,w),m(this,T,{writable:!0,value:void 0}),m(this,O,{writable:!0,value:void 0}),this.isTesting=!1,this.isInit=!1}}function v(){g(this,T,this.add.graphics()),c(this,T).fillStyle(0xef6c00,1),c(this,T).fillRoundedRect(this.cameras.main.width/4-2,this.cameras.main.height-100,this.cameras.main.width/2+4,24,12),g(this,O,this.add.graphics())}function E(){p(this),S(this),k(this),f(this)}class P{createUI(){this.scene.add.image(this.scene.scale.width/2,this.scene.scale.height/2,y.image.backgroundGame).setDepth(-3).setScrollFactor(0).setDisplaySize(this.scene.scale.width,this.scene.scale.height),this.scene.add.image(this.scene.scale.width/2,0,y.image.backgroundLogo).setOrigin(.5,0).setScrollFactor(0).setDepth(-2).setScale(this.gameScene.setDynamicValueBasedOnScale(.4,1)),this.scene.add.image(this.scene.scale.width/2,0,y.image.logo).setOrigin(.5,0).setScrollFactor(0).setDepth(-1).setScale(this.gameScene.setDynamicValueBasedOnScale(.4,1)),this.scoreText=this.scene.add.text(this.gameScene.setDynamicValueBasedOnScale(140,230)+this.ofssetX,this.gameScene.setDynamicValueBasedOnScale(-80,115)+this.ofssetY,"".concat(this.score," / ").concat(this.maxScore),{fontFamily:"Paytone One",fontSize:"48px",color:"#000000"}),this.scoreText.setOrigin(.5).setScrollFactor(0).setDepth(1).setScale(this.gameScene.setDynamicValueBasedOnScale(.7,1.2)),this.originalScale=this.scoreText.scale,this.scene.add.image(this.gameScene.setDynamicValueBasedOnScale(50,80)+this.ofssetX,this.gameScene.setDynamicValueBasedOnScale(-75,110)+this.ofssetY,y.image.iconScore).setOrigin(.5).setScrollFactor(0).setDepth(1).setScale(this.gameScene.setDynamicValueBasedOnScale(.5,1)),this.scene.add.image(this.gameScene.setDynamicValueBasedOnScale(125,175)+this.ofssetX,this.gameScene.setDynamicValueBasedOnScale(-75,110)+this.ofssetY,y.image.backgroundScore).setOrigin(.5).setScrollFactor(0).setDepth(0).setScale(this.gameScene.setDynamicValueBasedOnScale(.8,1.4))}setGameScene(t){this.gameScene=t}updateScore(t){let e=this.score+t;this.score=e;let i=0;this.scene.time.addEvent({delay:50,repeat:t-1,callback:()=>{this.displayedScore+=1,this.scoreText.setText("".concat(this.displayedScore.toString()," / ").concat(this.maxScore)),this.scoreText.setScale(this.originalScale),this.scene.tweens.add({targets:this.scoreText,scale:{from:this.originalScale,to:1.3*this.originalScale},duration:100,ease:"Quad.easeOut",yoyo:!0}),++i>=t&&(this.scene.registry.set(y.registry.score,e),this.scoreText.setScale(this.originalScale),this.score>=this.maxScore&&(this.gameScene.gameOver(),console.log("Hai vinto!")))}})}constructor(t){this.score=0,this.maxScore=10,this.displayedScore=0,this.originalScale=1,this.ofssetY=200,this.ofssetX=0,this.scene=t}}class B{loadAudios(){for(let t in y.audio)this.audios[t]=this.scene.sound.add(t)}playAudio(t){this.audios[t]&&this.audios[t].play()}playBackgroundMusic(){this.scene.sound.add(y.audio.music).play({loop:!0,volume:.7})}constructor(t){this.audios={},this.scene=t}}var M=new WeakSet;class D{starsEffectAnimation(t){let{x:e,y:i}=t,s=u(this,M,G).call(this,y.keyAnim.animStars,y.spritesheet.starsEffect.key,19,e,i);s.setVisible(!0),s.setScale(.5),s.play(y.keyAnim.animStars),this.scene.time.delayedCall(19/this.frameRate*1e3,()=>{s.destroy()}),this.scene.time.delayedCall(500,()=>{let t=this.scene.add.text(e,i,"+1",{fontFamily:"Paytone One",fontSize:"60px",color:"#ffffff",stroke:"#000",strokeThickness:2});t.setOrigin(.5),t.setDepth(3),this.scene.tweens.add({targets:t,y:i+40,alpha:0,duration:1e3,ease:"Sine.easeIn",onComplete:()=>{t.destroy()}})})}constructor(t){b(this,M),this.frameRate=20,this.scene=t}}function G(t,e,i,s,a){return this.scene.anims.exists(t)||this.scene.anims.create({key:t,frames:this.scene.anims.generateFrameNumbers(e,{start:0,end:i}),frameRate:this.frameRate,repeat:0}),this.scene.add.sprite(s,a,e).setOrigin(.5).setVisible(!1).setScale(1).setDepth(2)}class I extends l().Scene{init(t){}create(){this.canShoot=!0,this.isGameOver=!1,this.basketScale=this.gameScene.getGlobalScale(),this.createWalls(),this.createBall(),this.createBasket(),this.createFloorZone(),this.trajectoryLine=this.add.graphics(),this.setupInput(),this.cameras.main.setBounds(0,0,this.scale.width,2*this.scale.height),this.cameras.main.scrollY=this.scale.height,this.physics.add.collider(this.ball,this.basketWalls),this.physics.add.collider(this.ball,this.walls),this.speedBall=this.gameScene.setDynamicValueBasedOnScale(750,1300),console.log("this.speedBall: "+this.speedBall)}update(){this.ballFollowBasket?this.ball.setPosition(this.basketImage.x+this.offsetX,this.basketImage.y+this.offsetY):this.isRotateActive&&Math.abs(this.rotationSpeed)>.001&&(this.ball.rotation+=this.rotationSpeed,this.rotationSpeed*=.995,.001>Math.abs(this.rotationSpeed)&&(this.rotationSpeed=0))}setGameScene(t){this.gameScene=t}createFloorZone(){let t=this.scale.width,e=this.scale.height,i=this.basketLateralWallHeight*this.basketScale*.4;this.floorZone=this.add.rectangle(t/2,2*e-20-i/2,t,i,65280,this.alphaRectangleTest),this.floorZone.setDepth(15),this.physics.add.existing(this.floorZone,!0),this.physics.add.overlap(this.ball,this.floorZone,()=>{this.ballHasLanded||this.ballInBasket||(this.ballHasLanded=!0,console.log("\uD83C\uDFC0 Palla toccata zona pavimento - Reset in 2 secondi"),this.ball.setBounce(.5*this.bounceBall),this.resetTimer&&this.resetTimer.destroy(),this.resetTimer=this.time.delayedCall(2e3,()=>{this.isGameOver||this.resetBall()}))},void 0,this)}createWalls(){this.walls=this.physics.add.staticGroup();let t=this.scale.width,e=this.scale.height,i=this.add.rectangle(10,e,20,2*e,9127187);this.physics.add.existing(i,!0),this.walls.add(i);let s=this.add.rectangle(t-10,e,20,2*e,9127187);this.physics.add.existing(s,!0),this.walls.add(s);let a=this.add.rectangle(t/2,10,t,20,9127187);this.physics.add.existing(a,!0),this.walls.add(a);let h=this.add.rectangle(t/2,2*e-10,t,20,9127187);this.physics.add.existing(h,!0),this.walls.add(h)}createBall(){let t=this.scale.width,e=this.scale.height;this.ballStartX=t/2,this.ballStartY=2*e-e*this.gameScene.setDynamicValueBasedOnScale(.15,.1),this.ball=this.physics.add.sprite(this.ballStartX,this.ballStartY,y.image.obj1),this.ball.setOrigin(.5),this.ball.setScale(this.basketScale);let i=this.ballColliderRadius,s=(this.ball.width-2*i)/2,a=(this.ball.height-2*i)/2;this.ball.setCircle(i,s,a),this.ball.setBounce(this.bounceBall),this.ball.setDrag(50),this.ball.setCollideWorldBounds(!1),this.ball.body.setAllowGravity(!1),this.ball.setVelocity(0,0),this.rotationSpeed=0,this.ball.setRotation(0),this.physics.add.collider(this.ball,this.walls,()=>{this.handleBallCollision()})}createBasket(){let t=this.scale.width,e=.6*this.scale.height+this.scale.height,i=t-20;this.basketImage=this.add.image(i,e,y.image.basket).setScale(this.basketScale).setDepth(10).setOrigin(1,.5),this.basketWalls=this.physics.add.staticGroup();let s=20*this.basketScale,a=(420-this.basketOffsetXLeft-this.basketOffsetXRight)*this.basketScale,h=(380-this.basketOffsetYTop-this.basketOffsetYBottom)*this.basketScale,n=i-420*this.basketScale*this.basketImage.originX+420*this.basketScale/2,r=this.basketLateralWallHeight*this.basketScale,o=this.basketLateralWallYOffset*this.basketScale,c=this.add.rectangle(n-a/2,e+o,s,r,43775,this.alphaRectangleTest);c.setDepth(15),this.physics.add.existing(c,!0),this.basketWalls.add(c);let d=this.add.rectangle(n+a/2,e+o,s,r,43775,this.alphaRectangleTest);d.setDepth(15),this.physics.add.existing(d,!0),this.basketWalls.add(d);let m=this.add.rectangle(n,e+h/2,a,s,43775,this.alphaRectangleTest);m.setDepth(15),this.physics.add.existing(m,!0),this.basketWalls.add(m),this.basketWalls.children.entries.forEach(t=>{t.originalData={baseX:t.x,baseY:t.y,baseWidth:t.width,baseHeight:t.height}});let g=.8*a,u=.4*r;this.scoreZone=this.add.rectangle(n,e+o+r/7,g,u,65280,this.alphaRectangleTest),this.scoreZone.setDepth(15),this.physics.add.existing(this.scoreZone,!0),this.basketWalls.add(this.scoreZone),this.physics.add.overlap(this.ball,this.scoreZone,()=>{this.ballInBasket||(this.ballInBasket=!0,console.log("Punto! La palla \xe8 entrata nel canestro."),this.gameScene.uiManager.updateScore(1+this.valueBonus),this.ball.setBounce(.5*this.bounceBall),this.rotationSpeed*=.3,this.scoreZone.body.enable=!1,this.resetTimer&&this.resetTimer.destroy(),this.time.delayedCall(100,()=>{this.offsetX=this.ball.x-this.basketImage.x,this.offsetY=this.ball.y-this.basketImage.y,this.ballFollowBasket=!0;let t=this.ball.body;t instanceof l().Physics.Arcade.Body&&(t.setVelocity(0,0),t.allowGravity=!1),this.rotationSpeed=0}),this.resetTimer=this.time.delayedCall(2e3,()=>{this.isGameOver||(this.resetBall(),this.repositionBasket(),this.ballFollowBasket=!1)}))},void 0,this),this.physics.add.collider(this.ball,this.basketWalls,()=>{this.handleBallCollision()})}resetBall(){console.log("Reset ball"),this.valueBonus=0,this.resetTimer&&(this.resetTimer.destroy(),this.resetTimer=void 0);let t=this.ball.body;this.ball.setPosition(this.ballStartX,this.ballStartY),this.ball.setVelocity(0,0),this.ball.setBounce(this.bounceBall),this.rotationSpeed=0,this.ball.setRotation(0),t.setAllowGravity(!1),this.ballInBasket=!1,this.ballHasLanded=!1,this.canShoot=!0,this.scoreZone.body.enable=!0,console.log("Palla resettata e pronta per un nuovo tiro.")}setupInput(){this.input.on("pointerdown",t=>{this.canShoot&&this.startDrag(t.x,t.y)}),this.input.on("pointermove",t=>{this.isDragging&&this.canShoot&&this.updateDrag(t.x,t.y)}),this.input.on("pointerup",t=>{this.isDragging&&this.canShoot&&this.endDrag(t.x,t.y)})}startDrag(t,e){this.canShoot&&(this.isDragging=!0,this.dragStartX=t,this.dragStartY=e,this.ball.setVelocity(0,0))}updateDrag(t,e){this.isDragging&&this.canShoot&&(this.dragEndX=t,this.dragEndY=e,this.drawTrajectoryLine())}endDrag(t,e){if(!this.isDragging||!this.canShoot)return;this.isDragging=!1,this.dragEndX=t,this.dragEndY=e;let i=l().Math.Angle.Between(this.dragStartX,this.dragStartY,this.dragEndX,this.dragEndY),s=Math.min(l().Math.Distance.Between(this.dragStartX,this.dragStartY,this.dragEndX,this.dragEndY)/100,2),a=this.ball.body;a.setAllowGravity(!0);let h=Math.cos(i)*this.speedBall*s,n=Math.sin(i)*this.speedBall*s;a.setVelocity(h,n),this.rotationSpeed=h/this.speedBall*this.maxRotationSpeed,this.rotationSpeed=l().Math.Clamp(this.rotationSpeed,-this.maxRotationSpeed,this.maxRotationSpeed),this.canShoot=!1,this.trajectoryLine.clear(),console.log("Palla lanciata!")}drawTrajectoryLine(){this.trajectoryLine.clear(),this.trajectoryLine.lineStyle(4,65280,.8),this.trajectoryLine.beginPath(),this.trajectoryLine.moveTo(this.dragStartX,this.dragStartY),this.trajectoryLine.lineTo(this.dragEndX,this.dragEndY),this.trajectoryLine.strokePath();let t=l().Math.Angle.Between(this.dragStartX,this.dragStartY,this.dragEndX,this.dragEndY);this.trajectoryLine.lineStyle(3,0xff0000,1);let e=this.dragEndX-20*Math.cos(t-.3),i=this.dragEndY-20*Math.sin(t-.3),s=this.dragEndX-20*Math.cos(t+.3),a=this.dragEndY-20*Math.sin(t+.3);this.trajectoryLine.beginPath(),this.trajectoryLine.moveTo(this.dragEndX,this.dragEndY),this.trajectoryLine.lineTo(e,i),this.trajectoryLine.strokePath(),this.trajectoryLine.beginPath(),this.trajectoryLine.moveTo(this.dragEndX,this.dragEndY),this.trajectoryLine.lineTo(s,a),this.trajectoryLine.strokePath()}repositionBasket(){let t,e;this.tweens.killAll();let i=this.scale.width,s=this.scale.height,a=Math.floor(2*Math.random()),h=Math.floor(3*Math.random()),l=.5*s+this.scale.height,n=l-s/5,r=l+l/6;1===h&&(r=l);let o=n+Math.random()*(r-n);0===a?(t=20,this.basketImage.setOrigin(0,.5)):(t=i-20,this.basketImage.setOrigin(1,.5)),this.basketImage.setPosition(t,o);let c=(420-this.basketOffsetXLeft-this.basketOffsetXRight)*this.basketScale,d=(380-this.basketOffsetYTop-this.basketOffsetYBottom)*this.basketScale;e=0===a?t+420*this.basketScale/2:t-420*this.basketScale/2;let m=this.basketLateralWallHeight*this.basketScale,g=this.basketLateralWallYOffset*this.basketScale,u=this.basketWalls.children.entries,b=u[0],y=u[1],p=u[2],S=e-c/2,k=o+g,f=e+c/2,T=o+g,O=o+d/2,x=o+g+m/7;b.setPosition(S,k),y.setPosition(f,T),p.setPosition(e,O),this.scoreZone.setPosition(e,x),b.body.updateFromGameObject(),y.body.updateFromGameObject(),p.body.updateFromGameObject(),this.scoreZone.body.updateFromGameObject();let w={image:this.basketImage,leftWall:b,rightWall:y,bottomWall:p,scoreZone:this.scoreZone};switch(h){case 0:break;case 1:let A=380*this.basketScale;this.tweens.add({targets:Object.values(w),y:"+=".concat(A/2),duration:2e3,ease:"Sine.easeInOut",yoyo:!0,repeat:-1,onUpdate:()=>{b.body.updateFromGameObject(),y.body.updateFromGameObject(),p.body.updateFromGameObject(),this.scoreZone.body.updateFromGameObject()}});break;case 2:let v=420*this.basketScale*1/3,E=0===a?1:-1;this.tweens.add({targets:Object.values(w),x:"+=".concat(v*E),duration:3e3,ease:"Sine.easeInOut",yoyo:!0,repeat:-1,onUpdate:()=>{b.body.updateFromGameObject(),y.body.updateFromGameObject(),p.body.updateFromGameObject(),this.scoreZone.body.updateFromGameObject()}})}this.physics.world.remove(b.body),this.physics.world.remove(y.body),this.physics.world.remove(p.body),this.physics.world.remove(this.scoreZone.body),this.physics.world.add(b.body),this.physics.world.add(y.body),this.physics.world.add(p.body),this.physics.world.add(this.scoreZone.body),this.createBonusObject(a,o,n,r,i,s)}createBonusObject(t,e,i,s,a,h){let l,n;this.bonusObject&&(this.bonusObject.destroy(),this.bonusObject=null),l=0===t?a-128-.3*a*Math.random():128+.3*a*Math.random();let r=Math.min(s,.5*h+this.scale.height-.25*h);n=r>i?i+Math.random()*(r-i):i,this.bonusObject=this.physics.add.sprite(l,n,y.image.bonus),this.bonusObject.setOrigin(.5),this.bonusObject.setScale(this.basketScale);let o=Math.min(this.bonusObject.width,this.bonusObject.height)/2,c=this.bonusObject.body;c.setCircle(o),c.setImmovable(!0),c.setAllowGravity(!1),this.ball&&this.physics.add.overlap(this.ball,this.bonusObject,()=>{console.log("Bonus collected!"),this.valueBonus=1,this.bonusObject&&(this.bonusObject.destroy(),this.bonusObject=null)})}handleBallCollision(){let t=this.ball.body;this.rotationSpeed=t.velocity.x/this.speedBall*this.maxRotationSpeed*.8,this.rotationSpeed=l().Math.Clamp(this.rotationSpeed,-this.maxRotationSpeed,this.maxRotationSpeed)}gameOver(){this.ball&&this.ball.destroy(),this.basketImage&&this.basketImage.destroy(),this.bonusObject&&this.bonusObject.destroy()}constructor(){super({key:y.scene.basketManager}),this.isDragging=!1,this.dragStartX=0,this.dragStartY=0,this.dragEndX=0,this.dragEndY=0,this.speedBall=750,this.canShoot=!0,this.isGameOver=!1,this.basketScale=.8,this.basketOffsetXLeft=40,this.basketOffsetXRight=30,this.basketOffsetYTop=30,this.basketOffsetYBottom=150,this.basketLateralWallHeight=220,this.basketLateralWallYOffset=0,this.ballInBasket=!1,this.bounceBall=.59,this.alphaRectangleTest=0,this.ballColliderRadius=75,this.ballStartX=0,this.ballStartY=0,this.ballFollowBasket=!1,this.offsetX=0,this.offsetY=0,this.rotationSpeed=0,this.maxRotationSpeed=.15,this.isRotateActive=!0,this.bonusObject=null,this.valueBonus=0,this.ballHasLanded=!1}}class R extends l().Scene{init(t){this.typeImage=t.typeImage,console.log("GameScene Bubble Shooter: ",this.typeImage)}create(){this.setGlobalScale(),this.initializeBasketManager(),console.log("Start Game Demo 02"),this.starsEffectManager=new D(this),this.uiManager=new P(this),this.uiManager.setGameScene(this),this.uiManager.createUI(),this.audioManager=new B(this),this.audioManager.loadAudios();let t=this.scene.get(y.scene.exitManager);t.setGameScene(this),this.exitButton=t.createExitButton(this,this.theme),this.scene.bringToTop(y.scene.exitManager),this.addLogoPhaser()}initializeBasketManager(){this.scene.manager.getScene(y.scene.basketManager)||this.scene.manager.add(y.scene.basketManager,I,!1),this.scene.launch(y.scene.basketManager,{gameScene:this}),this.basketManager=this.scene.get(y.scene.basketManager),this.basketManager.setGameScene(this)}addLogoPhaser(){this.add.image(this.scale.width-50,this.scale.height-50,"logoPhaser").setOrigin(.5).setDepth(-1).setScale(this.setDynamicValueBasedOnScale(.7,1))}getGlobalScale(){return this.globalScale}setGlobalScale(){let t=window.innerWidth,e=window.innerHeight,i=window.devicePixelRatio||1,s=this.sys.game.config,a=void 0,h=void 0,l=Math.min(1.2,Math.max(.59,Math.min(s.width/1080,s.height/1920)));!(t*i>=2500||e*i>=1400)&&t<750&&e<450&&(l*=.7),this.globalScale=Math.round(100*l)/100,console.log("SetglobalScale: ",this.globalScale)}setDynamicValueBasedOnScale(t,e){return this.globalScale>=1?e:this.globalScale<=.5?t:t+(this.globalScale-.5)/.5*(e-t)}startAnimConfetti(){let t=this.sys.game.config,e=this.add.sprite(0,t.height/2,y.spritesheet.confetti_left.key).setOrigin(0,.5).setDepth(15).setScale(5).setScrollFactor(0);this.anims.create({key:"animConfettiLeft",frames:this.anims.generateFrameNumbers(y.spritesheet.confetti_left.key,{start:0,end:54}),frameRate:20}),e.play("animConfettiLeft");let i=this.add.sprite(t.width,t.height/2,y.spritesheet.confetti_right.key).setOrigin(1,.5).setDepth(15).setScale(5).setScrollFactor(0);this.anims.create({key:"animConfettiRight",frames:this.anims.generateFrameNumbers(y.spritesheet.confetti_right.key,{start:0,end:54}),frameRate:20}),i.play("animConfettiRight")}gameOver(){if(!this.isGameOver){this.isGameOver=!0,this.basketManager.isGameOver=!0,this.basketManager.canShoot=!1;let t=1e3;this.uiManager.score>=this.uiManager.maxScore?(console.log("HAI VINTO LA PARTITA COMPLIMENTI!!!"),this.startAnimConfetti(),t=3e3,this.audioManager.playAudio(y.audio.endWin)):(console.log("HAI PERSO LA PARTITA!!!"),t=1e3,this.audioManager.playAudio(y.audio.endFailed)),this.time.delayedCall(t,()=>{this.theme&&this.theme.stop(),this.basketManager.gameOver(),this.scene.start(y.scene.outro,{resultStatus:this.uiManager.score>=this.uiManager.maxScore?"Win":"Failed"})}),console.log("Gioco finito!")}}constructor(){super({key:y.scene.game}),this.globalScale=1,this.isGameOver=!1}}var C=i(9099),j=i.n(C);class W extends Phaser.Scene{init(t){let{resultStatus:e}=t;"Failed"!==e&&(this.imageKey="end".concat(e)),this.time.delayedCall(3e3,()=>{j().push("/home")},[],this)}create(){let{width:t,height:e}=this.scale;this.add.image(t/2,e/2,this.imageKey).setOrigin(.5,.5).setDisplaySize(this.scale.width,this.scale.height),console.log("registry.score: ",this.registry.get(y.registry.score))}constructor(){super({key:y.scene.outro}),this.imageKey="endFailed"}}var L=new WeakSet,V=new WeakSet,Y=new WeakSet,F=new WeakSet,_=new WeakSet,N=new WeakSet;class X extends Phaser.Scene{create(){console.log("tutorial"),this.setGlobalScale(),this.addRoadAndBackgroundRoad(),this.addBackgroundOverlay(),this.addAnims(),this.addButton(.8,.7),this.startAnimation(.8,.7)}addRoadAndBackgroundRoad(){}addBackgroundOverlay(){this.backgroundOverlay=this.add.graphics(),this.backgroundOverlay.fillStyle(0,.5),this.backgroundOverlay.fillRect(0,0,this.width,this.height),this.backgroundOverlay.setDepth(100)}addAnims(){this.tutorialPlayer01=u(this,F,U).call(this,y.keyAnim.animTutorialPlayer01,y.spritesheet.tutorialPlayer01.key,38),this.tutorialText01=u(this,_,z).call(this,y.keyAnim.animStartTutorialText01,y.spritesheet.tutorialText01.key,0,2),this.tutorialText01=u(this,_,z).call(this,y.keyAnim.animEndTutorialText01,y.spritesheet.tutorialText01.key,3,5),this.tutorialPlayer02=u(this,F,U).call(this,y.keyAnim.animTutorialPlayer02,y.spritesheet.tutorialPlayer02.key,37),this.tutorialText02=u(this,_,z).call(this,y.keyAnim.animStartTutorialText02,y.spritesheet.tutorialText02.key,0,2),this.tutorialText02=u(this,_,z).call(this,y.keyAnim.animEndTutorialText02,y.spritesheet.tutorialText02.key,3,5),this.tutorialPlayer03=u(this,F,U).call(this,y.keyAnim.animTutorialPlayer03,y.spritesheet.tutorialPlayer03.key,38),this.tutorialText03=u(this,_,z).call(this,y.keyAnim.animStartTutorialText03,y.spritesheet.tutorialText03.key,0,2),this.tutorialText03=u(this,_,z).call(this,y.keyAnim.animEndTutorialText03,y.spritesheet.tutorialText03.key,3,5)}addButton(t,e){this.startButton=this.add.sprite(this.width/2,this.height-50,y.image.tutorialTastoAvanti).setInteractive().setOrigin(.5,1).setScrollFactor(0).setScale(t*this.globalScale).setDepth(102).on("pointerup",()=>{u(this,N,Q).call(this,t,e)}),this.isTutorialActive=!0}startAnimation(t,e){u(this,L,H).call(this,t,e)}setGlobalScale(){let t=window.innerWidth,e=window.innerHeight,i=window.devicePixelRatio||1,s=this.sys.game.config;this.width=s.width,this.height=s.height;let a=void 0,h=void 0,l=Math.min(1.2,Math.max(.59,Math.min(this.width/1080,this.height/1920)));!(t*i>=2500||e*i>=1400)&&t<750&&e<450&&(l*=.7),this.globalScale=Math.round(100*l)/100,console.log("Scala applicata tutorial:",this.globalScale),console.log("Dimensioni scena width height:",this.width,this.height)}setDynamicValueBasedOnScale(t,e){return this.globalScale>=1?e:this.globalScale<=.5?t:t+(this.globalScale-.5)/.5*(e-t)}constructor(){super({key:y.scene.tutorial}),b(this,L),b(this,V),b(this,Y),b(this,F),b(this,_),b(this,N),this.globalScale=1,this.frameRate=8,this.isTutorialActive=!0}}function H(t,e){this.isTutorialActive&&(this.tutorialPlayer02.setVisible(!1),this.tutorialText02.setVisible(!1),this.tutorialPlayer03.setVisible(!1),this.tutorialText03.setVisible(!1),this.tutorialPlayer01.setVisible(!0),this.tutorialPlayer01.play(y.keyAnim.animTutorialPlayer01),this.tutorialPlayer01.on(Phaser.Animations.Events.ANIMATION_UPDATE,(t,e)=>{this.isTutorialActive&&t.key===y.keyAnim.animTutorialPlayer01&&12===e.index&&(this.tutorialText01.setVisible(!0),this.tutorialText01.play(y.keyAnim.animStartTutorialText01))}),this.tutorialPlayer01.once(Phaser.Animations.Events.ANIMATION_COMPLETE_KEY+y.keyAnim.animTutorialPlayer01,()=>{this.tutorialText01.play(y.keyAnim.animEndTutorialText01),this.tutorialText01.once(Phaser.Animations.Events.ANIMATION_COMPLETE_KEY+y.keyAnim.animEndTutorialText01,()=>{u(this,V,Z).call(this,t,e)})}))}function Z(t,e){this.isTutorialActive&&(this.tutorialPlayer01.setVisible(!1),this.tutorialText01.setVisible(!1),this.tutorialPlayer02.setVisible(!0),this.tutorialPlayer02.play(y.keyAnim.animTutorialPlayer02),this.tutorialPlayer02.on(Phaser.Animations.Events.ANIMATION_UPDATE,(t,e)=>{this.isTutorialActive&&t.key===y.keyAnim.animTutorialPlayer02&&12===e.index&&(this.tutorialText02.setVisible(!0),this.tutorialText02.play(y.keyAnim.animStartTutorialText02))}),this.tutorialPlayer02.once(Phaser.Animations.Events.ANIMATION_COMPLETE_KEY+y.keyAnim.animTutorialPlayer02,()=>{this.tutorialText02.play(y.keyAnim.animEndTutorialText02),this.tutorialText02.once(Phaser.Animations.Events.ANIMATION_COMPLETE_KEY+y.keyAnim.animEndTutorialText02,()=>{u(this,Y,K).call(this,t,e)})}))}function K(t,e){this.isTutorialActive&&(this.tutorialPlayer02.setVisible(!1),this.tutorialText02.setVisible(!1),this.tutorialPlayer03.setVisible(!0),this.tutorialPlayer03.play(y.keyAnim.animTutorialPlayer03),this.tutorialPlayer03.on(Phaser.Animations.Events.ANIMATION_UPDATE,(t,e)=>{this.isTutorialActive&&t.key===y.keyAnim.animTutorialPlayer03&&12===e.index&&(this.tutorialText03.setVisible(!0),this.tutorialText03.play(y.keyAnim.animStartTutorialText03))}),this.tutorialPlayer03.once(Phaser.Animations.Events.ANIMATION_COMPLETE_KEY+y.keyAnim.animTutorialPlayer03,()=>{this.tutorialText03.play(y.keyAnim.animEndTutorialText03),this.tutorialText03.once(Phaser.Animations.Events.ANIMATION_COMPLETE_KEY+y.keyAnim.animEndTutorialText03,()=>{this.isTutorialActive&&u(this,N,Q).call(this,t,e)})}))}function U(t,e,i){return this.anims.create({key:t,frames:this.anims.generateFrameNumbers(e,{start:0,end:i}),frameRate:this.frameRate,repeat:0}),this.add.sprite(this.width/2,this.height/2+50,e).setOrigin(.5).setVisible(!1).setScale(2*this.globalScale).setDepth(101)}function z(t,e,i,s){return this.anims.create({key:t,frames:this.anims.generateFrameNumbers(e,{start:i,end:s}),frameRate:this.frameRate,repeat:0}),this.add.sprite(this.width/2+50,100,e).setOrigin(.5,0).setVisible(!1).setScale(+this.globalScale).setDepth(101)}function Q(t,e){this.isTutorialActive=!1,this.startButton.setScale(e*this.globalScale),this.time.delayedCall(200,()=>{this.startButton.setScale(t*this.globalScale),this.scene.start(y.scene.game)})}var q=new WeakSet,J=new WeakSet;class $ extends Phaser.Scene{create(){let t=this.sys.game.config;this.height=t.height,this.width=t.width,this.scene.isActive(y.scene.game)&&(this.scene.pause(y.scene.game),this.sound.pauseAll()),u(this,q,tt).call(this),u(this,J,te).call(this)}setGameScene(t){this.gameScene=t}createExitButton(t,e){let i=t.sys.game.config.width,s=t.registry.get("test"),a=t.add.image(i-this.gameScene.setDynamicValueBasedOnScale(50,120),this.gameScene.setDynamicValueBasedOnScale(50,120),y.image.btnExitGame).setOrigin(.5).setInteractive().setScrollFactor(0).setDepth(100).setScale(this.gameScene.setDynamicValueBasedOnScale(.35,1));return a.on("pointerdown",()=>{s?(e&&e.stop(),j().push("/home")):(t.scene.launch(y.scene.exitManager),t.scene.get(y.scene.exitManager))}),a}constructor(t){super({key:y.scene.exitManager}),b(this,q),b(this,J),this.gameScene=t}}function tt(){this.backgroundOverlay=this.add.graphics(),this.backgroundOverlay.fillStyle(0,.5),this.backgroundOverlay.fillRect(0,0,this.width,this.height),this.backgroundOverlay.setDepth(100)}function te(){let t=this.width/2,e=this.height/2;this.popupContainer=this.add.container(t,e).setDepth(101).setScrollFactor(0).setScale(this.gameScene.setDynamicValueBasedOnScale(.4,1.1));let i=this.add.image(0,0,y.image.popupExitGame).setOrigin(.5).setDepth(101),s=this.add.image(-277,250,y.image.btnCancel).setOrigin(.5).setDepth(102).setInteractive({useHandCursor:!0});s.on("pointerdown",()=>{this.backgroundOverlay.setVisible(!1),this.popupContainer.setVisible(!1),this.scene.isActive(y.scene.game)||(this.scene.resume(y.scene.game),this.sound.resumeAll())});let a=this.add.image(267.5,250,y.image.btnConfirm).setOrigin(.5).setDepth(102).setInteractive({useHandCursor:!0});a.on("pointerdown",()=>{let t=this.scene.get(y.scene.game);t.theme&&t.theme.stop(),j().push("/home")}),this.popupContainer.add([i,s,a])}class ti extends Phaser.Scene{create(){this.addTimer(),this.registry.set(y.registry.timer,this.timerGame)}init(){this.timer=this.timerGame}setGameScene(t){this.gameScene=t}addTimer(){let t=this.sys.game.config;this.timerText=this.add.text(t.width-this.gameScene.setDynamicValueBasedOnScale(110,180)+this.ofssetX,this.gameScene.setDynamicValueBasedOnScale(-80,115)+this.ofssetY,this.timer.toString(),{fontFamily:"Paytone One",fontSize:"48px",color:"#000000"}),this.timerText.setOrigin(.5).setScrollFactor(0).setScale(this.gameScene.setDynamicValueBasedOnScale(.7,1.2)),this.add.sprite(t.width-this.gameScene.setDynamicValueBasedOnScale(50,80)+this.ofssetX,this.gameScene.setDynamicValueBasedOnScale(-75,110)+this.ofssetY,y.image.iconSandClock).setOrigin(.5).setScrollFactor(0).setScale(this.gameScene.setDynamicValueBasedOnScale(.5,1))}startTimer(){this.time.addEvent({delay:1e3,callback:this.updateTimer,callbackScope:this,loop:!0})}updateTimer(){this.timer--,this.timerTemp=this.timer;let t=+this.registry.get(y.registry.timer)+1;this.registry.set(y.registry.timer,t),this.timerText&&this.timerText.setText(this.timer.toString()),this.timer<=0&&this.stopTimer()}stopTimer(){this.countdown&&(this.countdown.remove(),this.countdown=null),this.time.removeAllEvents(),this.timerTemp=this.timer}resetTimer(){this.timer=this.timerGame,this.timerTemp=0,this.registry.set(y.registry.timer,this.timer),this.time.delayedCall(2e3,()=>{this.timerTemp=this.timer})}constructor(){super({key:y.scene.timerManager}),this.timer=0,this.timerGame=120,this.timerTemp=0,this.countdown=null,this.timerText=null,this.ofssetY=200,this.ofssetX=0}}let ts={type:Phaser.CANVAS,width:1920,height:1080,parent:"game-container",autoRound:!1,scale:{mode:Phaser.Scale.ENVELOP,autoCenter:Phaser.Scale.CENTER_BOTH,height:window.innerHeight*window.devicePixelRatio,width:window.innerWidth*window.devicePixelRatio},physics:{default:"arcade",arcade:{gravity:{y:1200,x:0},debug:!1}},transparent:!0,input:{activePointers:3},scene:[]};var ta=i(8230),th=i.n(ta);function tl(t){let{isTesting:e,setLevelComplete:i,setExitGame:l}=t,o=(0,a.useRef)(null),c=(0,a.useRef)(null),[d,m]=(0,a.useState)({backgroundImage:"url('/games/basket/images/loadingBackground.jpg')",backgroundSize:"cover",backgroundPosition:"center",width:"100%",height:"100%"});return(0,a.useEffect)(()=>{if(!o.current)return;let t=new h.Game({...ts,parent:o.current});c.current=t,t.scene.add(y.scene.boot,A),t.scene.add(y.scene.game,R),t.scene.add(y.scene.tutorial,X),t.scene.add(y.scene.timerManager,ti),t.scene.add(y.scene.basketManager,I),t.scene.add(y.scene.exitManager,$),t.scene.add(y.scene.outro,W);let i="/games/basket/images/logo_purinaone.png",s="/games/basket/images/brand_NoBrand.png";i="/games/platformer/images/logo_nescafe.png",s="/games/basket/images/brand_nescafe.png",t.scene.start(y.scene.boot,{logo:i,brand:s,isTesting:e,logoPhaser:"/games/basket/images/logoPhaser.png"});let a=()=>{th()},l=()=>{th()},d=()=>{console.log("handleChangeBackground"),m({backgroundColor:"black",width:"100%",height:"100%"})};return n.on(r.END_GAME,a),n.on(r.EXIT_GAME,l),n.on(r.CHANGE_BACKGROUND,d),()=>{n.off(r.END_GAME,a),n.off(r.EXIT_GAME,l),n.on(r.CHANGE_BACKGROUND,d),c.current&&(c.current.destroy(!0),c.current=null)}},[e]),(0,s.jsx)("div",{style:d,children:(0,s.jsx)("div",{ref:o})})}},9099:(t,e,i)=>{t.exports=i(8253)}}]);